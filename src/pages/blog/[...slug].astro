---
import { getCollection, render } from "astro:content";
import BlogPostLayout from "../../layouts/BlogPostLayout.astro";

export async function getStaticPaths() {
  const posts = await getCollection("blog");
  return posts.map((post) => ({
    params: { slug: post.id },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await render(post);
---

<BlogPostLayout frontmatter={post.data}>
  <div class="stack-column gap-3">
    <div class="stack-column gap-1 fade-in align-center">
      <h5 class="surtitle">Blog</h5>
      <h1>{post.data.title}</h1>

      <p>
        {
          post.data.pubDate
            .toLocaleDateString("fr-FR", {
              weekday: "long",
              day: "2-digit",
              month: "long",
              year: "numeric",
            })
            .replace(/^./, (str) => str.toUpperCase())
        }
      </p>
      <img src={post.data.image} class="image-article" />
    </div>

    <div class="article-content-container fade-in">
      <Content />
    </div>
  </div>
</BlogPostLayout>

<style>
  .article-content-container {
    max-width: 650px;
    margin: 0 auto;
  }
  .header-article {
    text-align: center;
  }
  .article-content-container p {
    line-height: 1.8;
  }
  .article-content-container li {
    line-height: 1.8;
  }
</style>
